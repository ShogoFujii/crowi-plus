webpackJsonp([1],{1108:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(1109),d=r(p),h=n(410),m=r(h),y=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={location:location,searchingKeyword:n.props.query.q||"",searchedKeyword:"",searchedPages:[],searchResultMeta:{},searchError:null},n.search=n.search.bind(n),n.changeURL=n.changeURL.bind(n),n}return i(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this.state.searchingKeyword;""!==e&&this.search({keyword:e})}},{key:"changeURL",value:function(e,t){var n=location.hash||"";(t||""!==this.state.searchedKeyword)&&(n=""),window.history&&window.history.pushState&&window.history.pushState("","Search - "+e,"/_search?q="+e+n)}},{key:"search",value:function(e){var t=this,n=e.keyword;if(""===n)return this.setState({searchingKeyword:"",searchedPages:[],searchResultMeta:{},searchError:null}),!0;this.setState({searchingKeyword:n}),this.props.crowi.apiGet("/search",{q:n}).then((function(e){t.changeURL(n),t.setState({searchedKeyword:n,searchedPages:e.data,searchResultMeta:e.meta})})).catch((function(e){t.setState({searchError:e})}))}},{key:"render",value:function(){return l.default.createElement("div",null,l.default.createElement("div",{className:"header-wrap"},l.default.createElement("header",null,l.default.createElement(d.default,{onSearchFormChanged:this.search,keyword:this.state.searchingKeyword}))),l.default.createElement(m.default,{pages:this.state.searchedPages,searchingKeyword:this.state.searchingKeyword,searchResultMeta:this.state.searchResultMeta}))}}],[{key:"getQueryByLocation",value:function(e){var t=e.search||"",n={};return t.replace(/^\?/,"").split("&").forEach((function(e){var t=e.split("=");n[t[0]]=decodeURIComponent(t[1]).replace(/\+/g," ")})),n}}]),t})(l.default.Component);t.default=y,y.propTypes={query:f.default.object},y.defaultProps={query:y.getQueryByLocation(location||{}),searchError:null}},1109:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={keyword:n.props.keyword,searchedKeyword:n.props.keyword},n.handleSubmit=n.handleSubmit.bind(n),n.handleChange=n.handleChange.bind(n),n}return i(t,e),u(t,[{key:"search",value:function(){this.state.searchedKeyword!=this.state.keyword&&(this.props.onSearchFormChanged({keyword:this.state.keyword}),this.setState({searchedKeyword:this.state.keyword}))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.search({keyword:this.state.keyword})}},{key:"handleChange",value:function(e){var t=e.target.value;this.setState({keyword:t})}},{key:"render",value:function(){return l.default.createElement("form",{className:"form form-group input-group",onSubmit:this.handleSubmit},l.default.createElement("input",{type:"text",name:"q",value:this.state.keyword,onChange:this.handleChange,className:"form-control"}),l.default.createElement("span",{className:"input-group-btn"},l.default.createElement("button",{type:"submit",className:"btn btn-default"},l.default.createElement("i",{className:"search-top-icon fa fa-search"}))))}}]),t})(l.default.Component);t.default=p,p.propTypes={onSearchFormChanged:f.default.func.isRequired},p.defaultProps={}},1110:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(59),d=r(p),h=n(408),m=r(h),y=n(409),b=r(y),v=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.page,t=this.props.linkTo;return""===t&&(t=e.path),l.default.createElement("li",{className:"page-list-li"},this.props.children,l.default.createElement(d.default,{user:e.revision.author}),l.default.createElement("a",{className:"page-list-link",href:t},l.default.createElement(b.default,{page:e,excludePathString:this.props.excludePathString})),l.default.createElement(m.default,{page:e}))}}]),t})(l.default.Component);t.default=v,v.propTypes={page:f.default.object.isRequired,linkTo:f.default.string},v.defaultProps={page:{},linkTo:"",excludePathString:""}},1111:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(1112),d=r(p),h=(function(t){function n(e){return o(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return i(n,t),u(n,[{key:"render",value:function(){var t=this,n=e("#content-main").data("linebreaks-enabled"),r={marked:{breaks:n}},o=this.props.pages.map((function(e){var n=e.revision.body;return l.default.createElement("div",{id:e._id,key:e._id,className:"search-result-page"},l.default.createElement("h2",null,l.default.createElement("a",{href:e.path},e.path)),l.default.createElement("div",{className:"wiki"},l.default.createElement(d.default,{className:"hige",page:e,pageBody:n,highlightKeywords:t.props.searchingKeyword,rendererOptions:r})))}));return l.default.createElement("div",null,o)}}]),n})(l.default.Component);t.default=h,h.propTypes={pages:f.default.array.isRequired,searchingKeyword:f.default.string.isRequired},h.defaultProps={pages:[],searchingKeyword:""}}).call(t,n(18))},1112:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.crowiRenderer=window.crowiRenderer,n.getMarkupHTML=n.getMarkupHTML.bind(n),n.getHighlightBody=n.getHighlightBody.bind(n),n}return i(t,e),u(t,[{key:"getHighlightBody",value:function(e,t){var n=e;return t.replace(/"/g,"").split(" ").forEach((function(e){if(""!==e){var t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/(^"|"$)/g,""),r=new RegExp("("+t+'(?!(.*?")))',"ig");n=n.replace(r,'<em class="highlighted">$&</em>')}})),n}},{key:"getMarkupHTML",value:function(){var e=this.props.pageBody;return""===e&&(e=this.props.page.revision.body),e=this.crowiRenderer.render(e,void 0,this.props.rendererOptions),this.props.highlightKeywords&&(e=this.getHighlightBody(e,this.props.highlightKeywords)),{__html:e}}},{key:"render",value:function(){var e=this.getMarkupHTML();return l.default.createElement("div",{className:"content",dangerouslySetInnerHTML:e})}}]),t})(l.default.Component);t.default=p,p.propTypes={page:f.default.object.isRequired,highlightKeywords:f.default.string,pageBody:f.default.string,rendererOptions:l.default.PropTypes.object},p.defaultProps={page:{},pageBody:"",rendererOptions:{}}},1113:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(410),d=r(p),h=(function(t){function n(t){o(this,n);var r=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return r.state={location:location,tree:e("#search-listpage-input").data("path"),searchingKeyword:r.props.query.q||"",searchedKeyword:"",searchedPages:[],searchResultMeta:{},searchError:null},r.changeURL=r.changeURL.bind(r),r.search=r.search.bind(r),r.handleChange=r.handleChange.bind(r),r}return i(n,t),u(n,[{key:"componentDidMount",value:function(){var t=this,n=e("#search-listpage-input");if(""!==this.state.searchingKeyword){var r=this.state.searchingKeyword;n.val(r),this.search({keyword:r})}e("#search-listpage-form").on("submit",(function(){var e=n.val();return e!=t.state.searchingKeyword&&t.search({keyword:e}),!1})),e("#search-listpage-clear").on("click",(function(){return n.val(""),t.search({keyword:""}),!1}))}},{key:"componentWillUnmount",value:function(){}},{key:"handleChange",value:function(e){var t=e.target.value;this.setState({searchedKeyword:t})}},{key:"stopSearching",value:function(){e("#content-main").show(),e("#search-listpage-clear").hide(),e(".main-container").removeClass("aside-hidden")}},{key:"startSearching",value:function(){e("#content-main").hide(),e("#search-listpage-clear").show(),e(".main-container").addClass("aside-hidden")}},{key:"changeURL",value:function(e,t){var n=this.state.tree,r=location.hash||"";(t||""!==this.state.searchedKeyword)&&(r=""),window.history&&window.history.pushState&&window.history.pushState("","Search - "+e,n+"?q="+e+r)}},{key:"search",value:function(e){var t=this,n=e.keyword||"",r=this.state.tree;if(this.changeURL(n),""===n)return this.stopSearching(),this.setState({searchingKeyword:"",searchedPages:[],searchResultMeta:{},searchError:null}),!0;this.startSearching(),this.setState({searchingKeyword:n}),this.props.crowi.apiGet("/search",{q:n,tree:r}).then((function(e){t.setState({searchedKeyword:n,searchedPages:e.data,searchResultMeta:e.meta})})).catch((function(e){t.setState({searchError:e})}))}},{key:"render",value:function(){return l.default.createElement("div",null,l.default.createElement("input",{type:"hidden",name:"q",value:this.state.searchingKeyword,onChange:this.handleChange,className:"form-control"}),l.default.createElement(d.default,{tree:this.state.tree,pages:this.state.searchedPages,searchingKeyword:this.state.searchingKeyword,searchResultMeta:this.state.searchResultMeta,searchError:this.state.searchError}))}}],[{key:"getQueryByLocation",value:function(e){var t=e.search||"",n={};return t.replace(/^\?/,"").split("&").forEach((function(e){var t=e.split("=");n[t[0]]=decodeURIComponent(t[1]).replace(/\+/g," ")})),n}}]),n})(l.default.Component);t.default=h,h.propTypes={query:f.default.object},h.defaultProps={query:h.getQueryByLocation(location||{})}}).call(t,n(18))},1114:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(82),d=r(p),h=n(1115),m=r(h),y=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={revisions:[],diffOpened:{}},n.getPreviousRevision=n.getPreviousRevision.bind(n),n.onDiffOpenClicked=n.onDiffOpenClicked.bind(n),n}return i(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.pageId;t&&this.props.crowi.apiGet("/revisions.ids",{page_id:t}).then((function(t){var n=t.revisions,r={},o=n.length-1;t.revisions.map((function(t,a){var i=e.props.crowi.findUserById(t.author);i&&(n[a].author=i),r[t._id]=0===a||a===o})),e.setState({revisions:n,diffOpened:r}),n[0]&&e.fetchPageRevisionBody(n[0]),n[1]&&e.fetchPageRevisionBody(n[1]),0!==o&&1!==o&&n[o]&&e.fetchPageRevisionBody(n[o])})).catch((function(e){}))}},{key:"getPreviousRevision",value:function(e){var t=null,n=!0,r=!1,o=void 0;try{for(var a,i=this.state.revisions[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var u=a.value;if(t&&t._id==e._id){t=u;break}t=u}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return t}},{key:"onDiffOpenClicked",value:function(e){var t=this.state.diffOpened,n=e._id;t[n]||(t[n]=!0,this.setState({diffOpened:t}),this.fetchPageRevisionBody(e),this.fetchPageRevisionBody(this.getPreviousRevision(e)))}},{key:"fetchPageRevisionBody",value:function(e){var t=this;e.body||this.props.crowi.apiGet("/revisions.get",{revision_id:e._id}).then((function(e){e.ok&&t.setState({revisions:t.state.revisions.map((function(t){return t._id==e.revision._id?e.revision:t}))})})).catch((function(e){}))}},{key:"render",value:function(){return l.default.createElement("div",null,l.default.createElement("h1",null,l.default.createElement(d.default,{name:"history"})," History"),l.default.createElement(m.default,{revisions:this.state.revisions,diffOpened:this.state.diffOpened,getPreviousRevision:this.getPreviousRevision,onDiffOpenClicked:this.onDiffOpenClicked}))}}]),t})(l.default.Component);t.default=y,y.propTypes={pageId:f.default.string,crowi:f.default.object.isRequired}},1115:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(1116),d=r(p),h=n(1118),m=r(h),y=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this,t=this.props.revisions,n=this.props.revisions.length,r=this.props.revisions.map((function(r,o){var a=r._id,i=e.props.diffOpened[a]||!1,u=void 0;return u=o+1<n?t[o+1]:r,l.default.createElement("div",{className:"revision-hisory-outer",key:"revision-history-"+a},l.default.createElement(d.default,{revision:r,onDiffOpenClicked:e.props.onDiffOpenClicked,key:"revision-history-rev-"+a}),l.default.createElement(m.default,{revisionDiffOpened:i,currentRevision:r,previousRevision:u,key:"revision-diff-"+a}))}));return l.default.createElement("div",{className:"revision-history-list"},r)}}]),t})(l.default.Component);t.default=y,y.propTypes={revisions:f.default.array,diffOpened:f.default.object,onDiffOpenClicked:f.default.func.isRequired}},1116:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),l=n(0),c=r(l),f=n(1),p=r(f),d=n(1117),h=r(d),m=n(82),y=r(m),b=n(59),v=r(b),g=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._onDiffOpenClicked=n._onDiffOpenClicked.bind(n),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){}},{key:"_onDiffOpenClicked",value:function(){this.props.onDiffOpenClicked(this.props.revision)}},{key:"render",value:function(){var e=this.props.revision,t=e.author,n="";return"object"===(void 0===t?"undefined":u(t))&&(n=c.default.createElement(v.default,{user:t})),c.default.createElement("div",{className:"revision-history-main"},n,c.default.createElement("div",{className:"revision-history-author"},c.default.createElement("strong",null,t.username)),c.default.createElement("div",{className:"revision-history-meta"},c.default.createElement("p",null,c.default.createElement(h.default,{dateTime:e.createdAt})),c.default.createElement("p",null,c.default.createElement("a",{href:"?revision="+e._id},c.default.createElement(y.default,{name:"history"})," View this version"),c.default.createElement("a",{className:"diff-view",onClick:this._onDiffOpenClicked},c.default.createElement(y.default,{name:"level-down"})," View diff"))))}}]),t})(c.default.Component);t.default=g,g.propTypes={revision:p.default.object,onDiffOpenClicked:p.default.func.isRequired}},1117:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(66),d=r(p),h=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=(0,d.default)(this.props.dateTime).format(this.props.format);return l.default.createElement("span",{className:this.props.className},e)}}]),t})(l.default.Component);t.default=h,h.propTypes={dateTime:f.default.string.isRequired,format:f.default.string,className:f.default.string},h.defaultProps={dateTime:"now",format:"YYYY/MM/DD HH:mm:ss",className:""}},1118:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(411),d=n(1119),h=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.currentRevision,t=this.props.previousRevision,n=this.props.revisionDiffOpened,r="";if(e.body&&t.body&&n){var o=t.body;e._id==t._id&&(o="");var a=(0,p.createPatch)(e.path,o,e.body);r=d.Diff2Html.getPrettyHtml(a)}var i={__html:r};return l.default.createElement("div",{className:"revision-history-diff",dangerouslySetInnerHTML:i})}}]),t})(l.default.Component);t.default=h,h.propTypes={currentRevision:f.default.object.isRequired,previousRevision:f.default.object.isRequired,revisionDiffOpened:f.default.bool.isRequired}},1122:function(e,t){},1128:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(66),d=r(p),h=n(414),m=r(h),y=n(59),b=r(y),v=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isCurrentUserIsAuthor=n.isCurrentUserEqualsToAuthor.bind(n),n.isCurrentRevision=n.isCurrentRevision.bind(n),n.getRootClassName=n.getRootClassName.bind(n),n.getRevisionLabelClassName=n.getRevisionLabelClassName.bind(n),n.deleteBtnClickedHandler=n.deleteBtnClickedHandler.bind(n),n}return i(t,e),u(t,[{key:"isCurrentUserEqualsToAuthor",value:function(){return this.props.comment.creator.username===this.props.currentUserId}},{key:"isCurrentRevision",value:function(){return this.props.comment.revision===this.props.currentRevisionId}},{key:"getRootClassName",value:function(){return"page-comment "+(this.isCurrentUserEqualsToAuthor()?"page-comment-me ":"")}},{key:"getRevisionLabelClassName",value:function(){return"page-comment-revision label "+(this.isCurrentRevision()?"label-primary":"label-default")}},{key:"deleteBtnClickedHandler",value:function(){this.props.deleteBtnClicked(this.props.comment)}},{key:"render",value:function(){var e=this.props.comment,t=e.creator,n=this.getRootClassName(),r=(0,d.default)(e.createdAt).format("YYYY/MM/DD HH:mm"),o=m.default.nl2br(e.comment),a="/user/"+t.username,i="?revision="+e.revision,u=e.revision.substr(0,8),s=this.getRevisionLabelClassName();return l.default.createElement("div",{className:n},l.default.createElement("a",{href:a},l.default.createElement(b.default,{user:t})),l.default.createElement("div",{className:"page-comment-main"},l.default.createElement("div",{className:"page-comment-creator"},l.default.createElement("a",{href:a},t.username)),l.default.createElement("div",{className:"page-comment-body"},o),l.default.createElement("div",{className:"page-comment-meta"},r," ",l.default.createElement("a",{className:s,href:i},u)),l.default.createElement("div",{className:"page-comment-control"},l.default.createElement("a",{className:"btn btn-link",onClick:this.deleteBtnClickedHandler},l.default.createElement("i",{className:"fa fa-trash-o"})))))}}]),t})(l.default.Component);t.default=v,v.propTypes={comment:f.default.object.isRequired,currentRevisionId:f.default.string.isRequired,currentUserId:f.default.string.isRequired,deleteBtnClicked:f.default.func.isRequired}},1129:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(183),d=n(66),h=r(d),m=n(414),y=r(m),b=n(59),v=r(b),g=(function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),u(t,null,[{key:"OMIT_BODY_THRES",get:function(){return 400}}]),u(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){if(void 0===this.props.comment)return l.default.createElement("div",null);var e=this.props.comment,n=(0,h.default)(e.createdAt).format("YYYY/MM/DD HH:mm"),r=e.comment;return r.length>t.OMIT_BODY_THRES&&(r=r.substr(0,t.OMIT_BODY_THRES)+"..."),r=y.default.nl2br(r),l.default.createElement(p.Modal,{show:this.props.isShown,onHide:this.props.cancel,className:"page-comment-delete-modal"},l.default.createElement(p.Modal.Header,{closeButton:!0},l.default.createElement(p.Modal.Title,null,"Delete comment?")),l.default.createElement(p.Modal.Body,null,l.default.createElement(v.default,{user:e.creator,size:"xs"})," ",l.default.createElement("strong",null,e.creator.username)," wrote on ",n,":",l.default.createElement("p",{className:"comment-body"},r)),l.default.createElement(p.Modal.Footer,null,l.default.createElement("span",{className:"text-danger"},this.props.errorMessage)," ",l.default.createElement(p.Button,{onClick:this.props.cancel},"Cancel"),l.default.createElement(p.Button,{onClick:this.props.confirmedToDelete,className:"btn-danger"},"Delete")))}}]),t})(l.default.Component);t.default=g,g.propTypes={isShown:f.default.bool.isRequired,comment:f.default.object,errorMessage:f.default.string,cancel:f.default.func.isRequired,confirmedToDelete:f.default.func.isRequired}},1130:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(413),d=r(p),h=(function(t){function n(e){return o(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return i(n,t),u(n,[{key:"componentWillMount",value:function(){var t=this.props.pageComments;void 0!==t&&e("#page-comment-form").on("submit",(function(){var n=e("#comment-form-button");return n.attr("disabled","disabled"),e.post("/_api/comments.add",e(this).serialize(),(function(r){n.prop("disabled",!1),r.ok?(t.init(),e("#comment-form-comment").val(""),e("#comment-form-message").text("")):e("#comment-form-message").text(r.error)})).fail((function(t){200!==t.status&&e("#comment-form-message").text(t.statusText)})),!1}))}},{key:"render",value:function(){return l.default.createElement("div",null)}}]),n})(l.default.Component);t.default=h,h.propTypes={pageComments:l.default.PropTypes.instanceOf(d.default),crowi:f.default.object.isRequired}}).call(t,n(18))},1131:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(82),f=(r(c),n(1132)),p=r(f),d=n(1134),h=r(d),m=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={attachments:[],inUse:{},attachmentToDelete:null,deleting:!1,deleteError:""},n.onAttachmentDeleteClicked=n.onAttachmentDeleteClicked.bind(n),n.onAttachmentDeleteClickedConfirm=n.onAttachmentDeleteClickedConfirm.bind(n),n}return i(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.pageId;t&&this.props.crowi.apiGet("/attachments.list",{page_id:t}).then((function(t){var n=t.attachments,r={},o=!0,a=!1,i=void 0;try{for(var u,s=n[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value;r[l._id]=e.checkIfFileInUse(l)}}catch(e){a=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(a)throw i}}e.setState({attachments:n,inUse:r})}))}},{key:"checkIfFileInUse",value:function(e){return!!this.props.pageContent.match(e.url)}},{key:"onAttachmentDeleteClicked",value:function(e){this.setState({attachmentToDelete:e})}},{key:"onAttachmentDeleteClickedConfirm",value:function(e){var t=this,n=e._id;this.setState({deleting:!0}),this.props.crowi.apiPost("/attachments.remove",{attachment_id:n}).then((function(e){t.setState({attachments:t.state.attachments.filter((function(e){return e._id!=n})),attachmentToDelete:null,deleting:!1})})).catch((function(e){t.setState({deleteError:"Something went wrong.",deleting:!1})}))}},{key:"isUserLoggedIn",value:function(){return""!==this.props.crowi.me}},{key:"render",value:function(){var e=this,t="";if(this.isUserLoggedIn()){var n=this.state.attachmentToDelete,r=function(){return e.setState({attachmentToDelete:null})},o=null!==n,a=null;null!==n&&(a=this.state.inUse[n._id]||!1),t=l.default.createElement(h.default,{show:o,animation:!1,onHide:r,attachmentToDelete:n,inUse:a,deleting:this.state.deleting,deleteError:this.state.deleteError,onAttachmentDeleteClickedConfirm:this.onAttachmentDeleteClickedConfirm})}return l.default.createElement("div",null,l.default.createElement("p",null,"Attachments"),l.default.createElement(p.default,{attachments:this.state.attachments,inUse:this.state.inUse,onAttachmentDeleteClicked:this.onAttachmentDeleteClicked,isUserLoggedIn:this.isUserLoggedIn()}),t)}}]),t})(l.default.Component);t.default=m},1132:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1133),f=r(c),p=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this;if(this.props.attachments<=0)return null;var t=this.props.attachments.map((function(t,n){return l.default.createElement(f.default,{key:"page:attachment:"+t._id,attachment:t,inUse:e.props.inUse[t._id]||!1,onAttachmentDeleteClicked:e.props.onAttachmentDeleteClicked,isUserLoggedIn:e.props.isUserLoggedIn})}));return l.default.createElement("ul",null,t)}}]),t})(l.default.Component);t.default=p},1133:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(82),d=r(p),h=n(415),m=r(h),y=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._onAttachmentDeleteClicked=n._onAttachmentDeleteClicked.bind(n),n}return i(t,e),u(t,[{key:"iconNameByFormat",value:function(e){return e.match(/image\/.+/i)?"file-image-o":"file-o"}},{key:"_onAttachmentDeleteClicked",value:function(e){this.props.onAttachmentDeleteClicked(this.props.attachment)}},{key:"render",value:function(){var e=this.props.attachment,t=(e._id,this.iconNameByFormat(e.fileFormat)),n="";this.props.inUse&&(n=l.default.createElement("span",{className:"attachment-in-use label label-info"},"In Use"));var r=l.default.createElement("span",{className:"attachment-filetype label label-default"},e.fileFormat),o=this.props.isUserLoggedIn?l.default.createElement("a",{className:"text-danger attachment-delete",onClick:this._onAttachmentDeleteClicked},l.default.createElement(d.default,{name:"trash-o"})):"";return l.default.createElement("li",null,l.default.createElement(m.default,{user:e.creator}),l.default.createElement(d.default,{name:t}),l.default.createElement("a",{href:e.url}," ",e.originalName),r,n,o)}}]),t})(l.default.Component);t.default=y,y.propTypes={attachment:f.default.object.isRequired,inUse:f.default.bool.isRequired,onAttachmentDeleteClicked:f.default.func.isRequired,isUserLoggedIn:f.default.bool.isRequired},y.defaultProps={}},1134:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),l=n(0),c=r(l),f=n(183),p=n(82),d=r(p),h=n(415),m=r(h),y=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._onDeleteConfirm=n._onDeleteConfirm.bind(n),n}return i(t,e),s(t,[{key:"_onDeleteConfirm",value:function(){this.props.onAttachmentDeleteClickedConfirm(this.props.attachmentToDelete)}},{key:"renderByFileFormat",value:function(e){return e.fileFormat.match(/image\/.+/i)?c.default.createElement("p",{className:"attachment-delete-image"},c.default.createElement("span",null,e.originalName," uploaded by ",c.default.createElement(m.default,{user:e.creator,username:!0})),c.default.createElement("img",{src:e.url})):c.default.createElement("p",{className:"attachment-delete-file"},c.default.createElement(d.default,{name:"file-o"}))}},{key:"render",value:function(){var e=this.props.attachmentToDelete;if(null===e)return null;var t=(this.props.inUse,Object.assign({},this.props));delete t.onAttachmentDeleteClickedConfirm,delete t.attachmentToDelete,delete t.inUse,delete t.deleting,delete t.deleteError;var n="";this.props.deleting&&(n=c.default.createElement(d.default,{name:"spinner",spin:!0})),this.props.deleteError&&(n=c.default.createElement("p",null,this.props.deleteError));var r=this.renderByFileFormat(e);return c.default.createElement(f.Modal,u({},t,{className:"attachment-delete-modal",bsSize:"large","aria-labelledby":"contained-modal-title-lg"}),c.default.createElement(f.Modal.Header,{closeButton:!0},c.default.createElement(f.Modal.Title,{id:"contained-modal-title-lg"},"Delete attachment?")),c.default.createElement(f.Modal.Body,null,r),c.default.createElement(f.Modal.Footer,null,n,c.default.createElement(f.Button,{onClick:this._onDeleteConfirm,bsStyle:"danger",disabled:this.props.deleting},"Delete!")))}}]),t})(c.default.Component);t.default=y},1135:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1136),f=r(c),p=(function(t){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={seenUsers:[]},t}return i(n,t),u(n,[{key:"componentDidMount",value:function(){var e=this.getSeenUserIds();e.length>0&&this.setState({seenUsers:this.props.crowi.findUserByIds(e)})}},{key:"getSeenUserIds",value:function(){var t=e("#seen-user-list");if(t.length>0){var n=t.data("seen-users");if(n)return n.split(",")}return[]}},{key:"render",value:function(){return l.default.createElement("div",{className:"seen-user-list"},l.default.createElement("p",{className:"seen-user-count"},this.state.seenUsers.length),l.default.createElement(f.default,{users:this.state.seenUsers}))}}]),n})(l.default.Component);t.default=p}).call(t,n(18))},1136:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(59),d=r(p),h=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"isSeenUserListShown",value:function(){var e=this.props.users.length;return 0<e&&e<=10}},{key:"render",value:function(){if(!this.isSeenUserListShown())return null;var e=this.props.users.map((function(e){return l.default.createElement("a",{key:e._id,"data-user-id":e._id,href:"/user/"+e.username,title:e.name},l.default.createElement(d.default,{user:e,size:"xs"}))}));return l.default.createElement("p",{className:"seen-user-list"},e)}}]),t})(l.default.Component);t.default=h,h.propTypes={users:f.default.array},h.defaultProps={users:[]}},1137:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(416),d=r(p),h=(function(t){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.state={pages:[],isListPage:!1,isLinkToListPage:!0},t}return i(n,t),u(n,[{key:"componentWillMount",value:function(){var e=this.props.pagePath.match(/\/$/);this.setState({isListPage:e});var t=this.props.crowi.getConfig().behaviorType,n="crowi-plus"!==t;this.setState({isLinkToListPage:n});var r=this.props.pagePath.split(/\//);r.shift(),""===r[r.length-1]&&r.pop();var o=[],a="/";r.forEach((function(e){o.push({pagePath:a+e,pageName:e}),a+=e+"/"})),this.setState({pages:o})}},{key:"showToolTip",value:function(){e("#btnCopy").tooltip("show"),setTimeout((function(){e("#btnCopy").tooltip("hide")}),1e3)}},{key:"generateLinkElementToListPage",value:function(e,t,n){return t?l.default.createElement("a",{href:e+"/",className:n&&!this.state.isListPage?"last-path":""},"/"):n?l.default.createElement("span",null):l.default.createElement("span",{className:"text-primary"},"/")}},{key:"render",value:function(){var e=this,t={marginRight:"0.2em"},n={marginLeft:"0.2em",marginRight:"0.2em"},r={fontSize:"0.6em",marginLeft:"0.5em",padding:"0 2px",border:"none"},o=this.state.pages.length,a=[];return this.state.pages.forEach((function(t,r){var i=r==o-1;a.push(l.default.createElement("span",{key:t.pagePath,className:"path-segment"},l.default.createElement("a",{href:t.pagePath},t.pageName))),a.push(l.default.createElement("span",{key:t.pagePath+"/",className:"separator",style:n},e.generateLinkElementToListPage(t.pagePath,e.state.isLinkToListPage,i)))})),l.default.createElement("span",null,l.default.createElement("span",{className:"separator",style:t},l.default.createElement("a",{href:"/"},"/")),a,l.default.createElement(d.default,{buttonId:"btnCopyRevisionPath",text:this.props.pagePath,buttonClassName:"btn btn-default btn-muted",iconClassName:"fa fa-clone text-muted"}),l.default.createElement("a",{href:"#edit-form",className:"btn btn-default btn-muted",style:r},l.default.createElement("i",{className:"fa fa-edit text-muted"})))}}]),n})(l.default.Component);t.default=h,h.propTypes={pagePath:f.default.string.isRequired,crowi:f.default.object.isRequired}}).call(t,n(18))},1147:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(416),f=r(c),p=(function(t){function n(){return o(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,t),u(n,[{key:"showToolTip",value:function(){e("#btnCopy").tooltip("show"),setTimeout((function(){e("#btnCopy").tooltip("hide")}),1e3)}},{key:"render",value:function(){var e={fontSize:"1em"},t=""===this.props.pageId?decodeURIComponent(location.href):location.origin+"/"+this.props.pageId,n=this.props.pagePath+"\n"+t;return l.default.createElement("span",null,t,l.default.createElement(f.default,{buttonId:"btnCopyRevisionUrl",text:n,buttonClassName:"btn btn-default btn-muted",buttonStyle:e,iconClassName:"fa fa-link text-muted"}))}}]),n})(l.default.Component);t.default=p,p.propTypes={pageId:l.default.PropTypes.string.isRequired,pagePath:l.default.PropTypes.string.isRequired}}).call(t,n(18))},1148:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(82),d=r(p),h=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={bookmarked:!1},n.handleClick=n.handleClick.bind(n),n}return i(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this;this.isUserLoggedIn()&&this.props.crowi.apiGet("/bookmarks.get",{page_id:this.props.pageId}).then((function(t){t.bookmark&&e.markBookmarked()}))}},{key:"handleClick",value:function(e){var t=this;e.preventDefault();var n=this.props.pageId;this.state.bookmarked?this.props.crowi.apiPost("/bookmarks.remove",{page_id:n}).then((function(e){t.markUnBookmarked()})):this.props.crowi.apiPost("/bookmarks.add",{page_id:n}).then((function(e){t.markBookmarked()}))}},{key:"markBookmarked",value:function(){this.setState({bookmarked:!0})}},{key:"markUnBookmarked",value:function(){this.setState({bookmarked:!1})}},{key:"isUserLoggedIn",value:function(){return""!==this.props.crowi.me}},{key:"render",value:function(){if(!this.isUserLoggedIn())return l.default.createElement("div",null);var e=this.state.bookmarked?"star":"star-o";return l.default.createElement("a",{href:"#",title:"Bookmark",className:"bookmark-link",onClick:this.handleClick},l.default.createElement(d.default,{name:e}))}}]),t})(l.default.Component);t.default=h,h.propTypes={pageId:f.default.string,crowi:f.default.object.isRequired}},18:function(e,t){e.exports=jQuery},279:function(e,t,n){function r(e){return n(o(e))}function o(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var a={"./ja":116,"./ja.js":116};r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=279},408:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"isPortalPath",value:function(e){return!!e.match(/.*\/$/)}},{key:"render",value:function(){var e=this.props.page,t=void 0;this.isPortalPath(e.path)&&(t=l.default.createElement("span",{className:"label label-info"},"PORTAL"));var n=void 0;e.commentCount>0&&(n=l.default.createElement("span",null,l.default.createElement("i",{className:"fa fa-comment"}),e.commentCount));var r=void 0;return e.liker.length>0&&(r=l.default.createElement("span",null,l.default.createElement("i",{className:"fa fa-thumbs-up"}),e.liker.length)),l.default.createElement("span",{className:"page-list-meta"},t,n,r)}}]),t})(l.default.Component);t.default=p,p.propTypes={page:f.default.object.isRequired},p.defaultProps={page:{}}},409:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"getShortPath",value:function(e){var t=e.replace(/(\/)$/,"");return t.match(/.+\/([^\/]+\/\d{4}\/\d{2}\/\d{2})$/)?t.replace(/.+\/([^\/]+\/\d{4}\/\d{2}\/\d{2})$/,"$1"):t.match(/.+\/([^\/]+\/\d{4}\/\d{2})$/)?t.replace(/.+\/([^\/]+\/\d{4}\/\d{2})$/,"$1"):t.match(/.+\/([^\/]+\/\d{4})$/)?t.replace(/.+\/([^\/]+\/\d{4})$/,"$1"):t.replace(/.+\/(.+)?$/,"$1")}},{key:"render",value:function(){var e=this.props.page,t=e.path.replace(this.props.excludePathString.replace(/^\//,""),""),n=this.getShortPath(t),r=n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o=t.replace(new RegExp(r+"(/)?$"),"");return l.default.createElement("span",{className:"page-path"},o,l.default.createElement("strong",null,n))}}]),t})(l.default.Component);t.default=p,p.propTypes={page:f.default.object.isRequired},p.defaultProps={page:{},excludePathString:""}},410:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(1110),d=r(p),h=n(1111),m=r(h),y=(function(t){function n(){return o(this,n),a(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,t),u(n,[{key:"isNotSearchedYet",value:function(){return!this.props.searchResultMeta.took}},{key:"isNotFound",value:function(){return""!==this.props.searchingKeyword&&0===this.props.pages.length}},{key:"isError",value:function(){return null!==this.props.searchError}},{key:"render",value:function(){var t=this.props.tree;if(this.isError())return l.default.createElement("div",{className:"content-main"},l.default.createElement("i",{className:"searcing fa fa-warning"})," Error on searching.");if(this.isNotSearchedYet())return l.default.createElement("div",null);if(this.isNotFound()){var n="";return""!==this.props.tree&&(n=' under "'+this.props.tree+'"'),l.default.createElement("div",{className:"content-main"},l.default.createElement("i",{className:"fa fa-meh-o"}),' No page found with "',this.props.searchingKeyword,'"',n)}var r=this.props.pages.map((function(e){var n="#"+e._id;return l.default.createElement(d.default,{page:e,linkTo:n,key:e._id,excludePathString:t},l.default.createElement("div",{className:"page-list-option"},l.default.createElement("a",{href:e.path},l.default.createElement("i",{className:"fa fa-arrow-circle-right"}))))}));return setTimeout((function(){e("#search-result-list > nav").affix({offset:{top:120}})}),1200),l.default.createElement("div",{className:"content-main"},l.default.createElement("div",{className:"search-result row",id:"search-result"},l.default.createElement("div",{className:"col-md-4 hidden-xs hidden-sm page-list search-result-list",id:"search-result-list"},l.default.createElement("nav",{"data-spy":"affix","data-offset-top":"120"},l.default.createElement("ul",{className:"page-list-ul page-list-ul-flat nav"},r))),l.default.createElement("div",{className:"col-md-8 search-result-content",id:"search-result-content"},l.default.createElement("div",{className:"search-result-meta"},l.default.createElement("i",{className:"fa fa-lightbulb-o"})," Found ",this.props.searchResultMeta.total,' pages with "',this.props.searchingKeyword,'"'),l.default.createElement(m.default,{pages:this.props.pages,searchingKeyword:this.props.searchingKeyword}))))}}]),n})(l.default.Component);t.default=y,y.propTypes={tree:f.default.string.isRequired,pages:f.default.array.isRequired,searchingKeyword:f.default.string.isRequired,searchResultMeta:f.default.object.isRequired},y.defaultProps={tree:"",pages:[],searchingKeyword:"",searchResultMeta:{},searchError:null}}).call(t,n(18))},413:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(1128),d=r(p),h=n(1129),m=r(h),y=(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={comments:[],isLayoutTypeCrowiPlus:!1,commentToDelete:void 0,isDeleteConfirmModalShown:!1,errorMessageForDeleting:void 0},n.init=n.init.bind(n),n.confirmToDeleteComment=n.confirmToDeleteComment.bind(n),n.deleteComment=n.deleteComment.bind(n),n.showDeleteConfirmModal=n.showDeleteConfirmModal.bind(n),n.closeDeleteConfirmModal=n.closeDeleteConfirmModal.bind(n),n}return i(t,e),u(t,[{key:"componentWillMount",value:function(){this.props.pageId&&this.init()}},{key:"init",value:function(){var e=this;if(this.props.pageId){var t=this.props.pageId,n=this.props.crowi.getConfig().layoutType;this.setState({isLayoutTypeCrowiPlus:"crowi-plus"===n}),this.props.crowi.apiGet("/comments.get",{page_id:t}).then((function(t){t.ok&&e.setState({comments:t.comments})})).catch((function(e){}))}}},{key:"confirmToDeleteComment",value:function(e){this.setState({commentToDelete:e}),this.showDeleteConfirmModal()}},{key:"deleteComment",value:function(){var e=this,t=this.state.commentToDelete;this.props.crowi.apiPost("/comments.remove",{comment_id:t._id}).then((function(n){n.ok&&e.findAndSplice(t),e.closeDeleteConfirmModal()})).catch((function(t){e.setState({errorMessageForDeleting:t.message})}))}},{key:"findAndSplice",value:function(e){var t=this.state.comments,n=t.indexOf(e);n<0||(t.splice(n,1),this.setState({comments:t}))}},{key:"showDeleteConfirmModal",value:function(){this.setState({isDeleteConfirmModalShown:!0})}},{key:"closeDeleteConfirmModal",value:function(){this.setState({commentToDelete:void 0,isDeleteConfirmModalShown:!1,errorMessageForDeleting:void 0})}},{key:"generateCommentElements",value:function(e){var t=this;return e.map((function(e){return l.default.createElement(d.default,{key:e._id,comment:e,currentUserId:t.props.crowi.me,currentRevisionId:t.props.revisionId,deleteBtnClicked:t.confirmToDeleteComment})}))}},{key:"render",value:function(){var e=[],t=[],n=[],r=this.state.comments;this.state.isLayoutTypeCrowiPlus&&(r=r.slice().reverse());var o=this.props.revisionId,a=this.props.revisionCreatedAt;r.forEach((function(r){r.revision==o?e.push(r):Date.parse(r.createdAt)/1e3>a?t.push(r):n.push(r)}));var i=this.generateCommentElements(e),u=this.generateCommentElements(t),s=this.generateCommentElements(n),c=l.default.createElement("div",{className:"page-comments-list-current",id:"page-comments-list-current"},i),f=l.default.createElement("div",{className:"page-comments-list-newer collapse",id:"page-comments-list-newer"},u),p=l.default.createElement("div",{className:"page-comments-list-older collapse in",id:"page-comments-list-older"},s),d=this.state.isLayoutTypeCrowiPlus?l.default.createElement("i",{className:"fa fa-angle-double-down"}):l.default.createElement("i",{className:"fa fa-angle-double-up"}),h=0===u.length?l.default.createElement("div",null):l.default.createElement("a",{className:"page-comments-list-toggle-newer text-center","data-toggle":"collapse",href:"#page-comments-list-newer"},d," Comments for Newer Revision ",d),y=this.state.isLayoutTypeCrowiPlus?l.default.createElement("i",{className:"fa fa-angle-double-up"}):l.default.createElement("i",{className:"fa fa-angle-double-down"}),b=0===s.length?l.default.createElement("div",null):l.default.createElement("a",{className:"page-comments-list-toggle-older text-center","data-toggle":"collapse",href:"#page-comments-list-older"},y," Comments for Older Revision ",y),v=this.state.isLayoutTypeCrowiPlus?l.default.createElement("div",null,p,b,c,h,f):l.default.createElement("div",null,f,h,c,b,p);return l.default.createElement("div",null,v,l.default.createElement(m.default,{isShown:this.state.isDeleteConfirmModalShown,comment:this.state.commentToDelete,errorMessage:this.state.errorMessageForDeleting,cancel:this.closeDeleteConfirmModal,confirmedToDelete:this.deleteComment}))}}]),t})(l.default.Component);t.default=y,y.propTypes={pageId:f.default.string,revisionId:f.default.string,revisionCreatedAt:f.default.number,crowi:f.default.object.isRequired}},414:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=n(0),i=(function(e){return e&&e.__esModule?e:{default:e}})(a),u=(function(){function e(){r(this,e)}return o(e,null,[{key:"nl2br",value:function(e){var t=/(\n)/g;return e.split(t).map((function(e){return e.match(t)?i.default.createElement("br",{key:Math.random().toString(10).substr(2,10)}):e}))}}]),e})();t.default=u},415:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=n(59),d=r(p),h=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.user,t="/user/"+e.username,n=this.props.username,r=this.props.name;return l.default.createElement("span",{className:"user-component"},l.default.createElement("a",{href:t},l.default.createElement(d.default,{user:e}),n&&l.default.createElement("span",{className:"user-component-username"},"@",e.username),r&&l.default.createElement("span",{className:"user-component-name"},"(",e.name,")")))}}]),t})(l.default.Component);t.default=h,h.propTypes={user:f.default.object.isRequired,name:f.default.bool.isRequired,username:f.default.bool.isRequired},h.defaultProps={name:!1,username:!1}},416:function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1138),f=r(c),p=(function(t){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.showToolTip=t.showToolTip.bind(t),t}return i(n,t),u(n,[{key:"showToolTip",value:function(){var t="#"+this.props.buttonId;e(t).tooltip("show"),setTimeout((function(){e(t).tooltip("hide")}),1e3)}},{key:"render",value:function(){var e={},t=Object.assign({fontSize:"0.8em",padding:"0 2px",border:"none",verticalAlign:"text-top"},this.props.buttonStyle);return l.default.createElement("span",{className:"btn-copy-container",style:e},l.default.createElement(f.default,{className:this.props.buttonClassName,"button-id":this.props.buttonId,"button-data-toggle":"tooltip","button-title":"copied!","button-data-placement":"bottom","button-data-trigger":"manual","button-style":t,"data-clipboard-text":this.props.text,onSuccess:this.showToolTip},l.default.createElement("i",{className:this.props.iconClassName})))}}]),n})(l.default.Component);t.default=p,p.propTypes={text:l.default.PropTypes.string.isRequired,buttonId:l.default.PropTypes.string.isRequired,buttonClassName:l.default.PropTypes.string.isRequired,buttonStyle:l.default.PropTypes.object,iconClassName:l.default.PropTypes.string.isRequired},p.defaultProps={buttonId:"btnCopy",buttonStyle:{}}}).call(t,n(18))},434:function(e,t,n){"use strict";(function(e){function t(e){return e&&e.__esModule?e:{default:e}}var r=n(0),o=t(r),a=n(16),i=t(a),u=n(524),s=t(u),l=n(548),c=t(l),f=n(827),p=t(f),d=n(1108),h=t(d),m=n(1113),y=t(m),b=n(1114),v=t(b),g=n(413),w=t(g),_=n(1130),k=t(_),O=n(1131),E=t(O),P=n(1135),j=t(P),C=n(1137),T=t(C),M=n(1147),S=t(M),R=n(1148),N=t(R);window||(window={});var I=document.querySelector("#content-main"),x=null,D=null,B=null,q=void 0,U=null;if(null!==I){x=I.attributes["data-page-id"].value,D=I.attributes["data-page-revision-id"].value,B=+I.attributes["data-page-revision-created"].value,q=I.attributes["data-path"].value;var L=document.getElementById("raw-text-original");L&&(U=L.innerHTML)}var A=new s.default({me:e("#content-main").data("current-username"),csrfToken:e("#content-main").data("csrftoken")},window);window.crowi=A,A.setConfig(JSON.parse(document.getElementById("crowi-context-hydrate").textContent||"{}")),A.fetchUsers();var K=new c.default(A);(window.crowiRenderer=K,e("body").data("plugin-enabled"))&&window.crowiPlugin.installAll(A,K);var F={"search-top":o.default.createElement(p.default,{crowi:A}),"search-page":o.default.createElement(h.default,{crowi:A}),"page-list-search":o.default.createElement(y.default,{crowi:A}),"page-comments-list":o.default.createElement(w.default,{pageId:x,revisionId:D,revisionCreatedAt:B,crowi:A}),"page-attachment":o.default.createElement(E.default,{pageId:x,pageContent:U,crowi:A}),"seen-user-list":o.default.createElement(j.default,{pageId:x,crowi:A}),"bookmark-button":o.default.createElement(N.default,{pageId:x,crowi:A})};q&&(F["revision-path"]=o.default.createElement(T.default,{pagePath:q,crowi:A}),F["revision-url"]=o.default.createElement(S.default,{pageId:x,pagePath:q}));var H={};Object.keys(F).forEach((function(e){var t=document.getElementById(e);t&&(H[e]=i.default.render(F[e],t))}));var $=document.getElementById("page-comment-form-behavior");$&&i.default.render(o.default.createElement(k.default,{crowi:A,pageComments:H["page-comments-list"]}),$),e('a[data-toggle="tab"][href="#revision-history"]').on("show.bs.tab",(function(){i.default.render(o.default.createElement(v.default,{pageId:x,crowi:A}),document.getElementById("revision-history"))}))}).call(t,n(18))},524:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),i=n(272),u=r(i),s=n(542),l=r(s),c=n(545),f=(function(){function e(t,n){o(this,e),this.context=t,this.config={},this.csrfToken=t.csrfToken,this.window=n,this.location=n.location||{},this.document=n.document||{},this.localStorage=n.localStorage||{},this.fetchUsers=this.fetchUsers.bind(this),this.apiGet=this.apiGet.bind(this),this.apiPost=this.apiPost.bind(this),this.apiRequest=this.apiRequest.bind(this),this.interceptorManager=new l.default,this.interceptorManager.addInterceptors([new c.DetachCodeBlockInterceptor(this),new c.RestoreCodeBlockInterceptor(this)]),this.me=t.me,this.users=[],this.userByName={},this.userById={},this.draft={},this.recoverData()}return a(e,[{key:"getCrowiForJquery",value:function(){return window.Crowi}},{key:"getContext",value:function(){return context}},{key:"setConfig",value:function(e){this.config=e}},{key:"getConfig",value:function(){return this.config}},{key:"recoverData",value:function(){var e=this;["userByName","userById","users","draft"].forEach((function(t){if(e.localStorage[t])try{e[t]=JSON.parse(e.localStorage[t])}catch(n){e.localStorage.removeItem(t)}}))}},{key:"fetchUsers",value:function(){var e=this,t=new Date;this.localStorage.lastFetched&&9e5>t-new Date(this.localStorage.lastFetched)||this.apiGet("/users.list",{}).then((function(t){e.users=t.users,e.localStorage.users=JSON.stringify(t.users);for(var n={},r={},o=0;o<t.users.length;o++){var a=t.users[o];n[a.username]=a,r[a._id]=a}e.userByName=n,e.localStorage.userByName=JSON.stringify(n),e.userById=r,e.localStorage.userById=JSON.stringify(r),e.localStorage.lastFetched=new Date})).catch((function(t){e.localStorage.removeItem("lastFetched")}))}},{key:"clearDraft",value:function(e){delete this.draft[e],this.localStorage.draft=JSON.stringify(this.draft)}},{key:"saveDraft",value:function(e,t){this.draft[e]=t,this.localStorage.draft=JSON.stringify(this.draft)}},{key:"findDraft",value:function(e){return this.draft&&this.draft[e]?this.draft[e]:null}},{key:"findUserById",value:function(e){return this.userById&&this.userById[e]?this.userById[e]:null}},{key:"findUserByIds",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var u=a.value,s=this.findUserById(u);s&&t.push(s)}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return t}},{key:"findUser",value:function(e){return this.userByName&&this.userByName[e]?this.userByName[e]:null}},{key:"apiGet",value:function(e,t){return this.apiRequest("get",e,{params:t})}},{key:"apiPost",value:function(e,t){return t._csrf||(t._csrf=this.csrfToken),this.apiRequest("post",e,t)}},{key:"apiRequest",value:function(e,t,n){return new Promise(function(r,o){u.default[e]("/_api"+t,n).then((function(e){e.data.ok?r(e.data):o(new Error(e.data.error))})).catch((function(e){o(e)}))})}}],[{key:"escape",value:function(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}},{key:"unescape",value:function(e){return e.replace(/&([#\w]+);/g,(function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}}]),e})();t.default=f},542:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=n(36)("crowi:InterceptorManager"),i=(function(){function e(){r(this,e),this.interceptors=[]}return o(e,[{key:"addInterceptor",value:function(e){this.addInterceptors([e])}},{key:"addInterceptors",value:function(e){var t=e.map((function(e){return e.getId()}));a("adding interceptors '"+t+"'"),this.interceptors=this.interceptors.concat(e)}},{key:"process",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];a("processing the context '"+e+"'");var i=this.interceptors.filter((function(t){return t.isInterceptWhen(e)})),u=i.filter((function(e){return e.isProcessableParallel()})),s=i.filter((function(e){return!e.isProcessableParallel()}));return a(u.length+" parallel interceptors found."),a(s.length+" sequencial interceptors found."),Promise.all(u.map((function(n){return t.doProcess.apply(t,[n,e].concat(r))})).concat([s.reduce((function(n,r){return n.then((function(){for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return t.doProcess.apply(t,[r,e].concat(o))}))}),Promise.resolve.apply(Promise,r))])).then((function(){a("end processing the context '"+e+"'")}))}},{key:"doProcess",value:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e.process.apply(e,[t].concat(r)).then((function(){return a("processing '"+e.getId()+"' in the context '"+t+"'"),Promise.resolve.apply(Promise,arguments)})).catch((function(n){return a("failed when processing '"+e.getId()+"' in the context '"+t+"'"),a(n),Promise.resolve.apply(Promise,r)}))}}]),e})();e.exports=i},545:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.RestoreCodeBlockInterceptor=t.DetachCodeBlockInterceptor=void 0;var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=(r(s),n(16)),c=(r(l),n(169)),f=(function(){function e(){i(this,e)}return u(e,null,[{key:"createReplaceStr",value:function(e){return"<pre>"+e+"</pre>"}}]),e})();t.DetachCodeBlockInterceptor=(function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.crowi=e,n.crowiForJquery=e.getCrowiForJquery(),n}return a(t,e),u(t,[{key:"isInterceptWhen",value:function(e){return"prePreProcess"===e}},{key:"process",value:function(e){var t=this,n=Object.assign(arguments.length<=1?void 0:arguments[1]),r=n.markdown;n.currentPagePath;return n.dcbContextMap={},n.markdown=r.replace(/```(.|[\r\n])*?```/gm,(function(e){var r="dcb-"+t.createRandomStr(8),o={};return o.content=e,o.substituteContent=f.createReplaceStr(r),n.dcbContextMap[r]=o,o.substituteContent})),Promise.resolve(n)}},{key:"createRandomStr",value:function(e){for(var t="abcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n}}]),t})(c.BasicInterceptor),t.RestoreCodeBlockInterceptor=(function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.crowi=e,n.crowiForJquery=e.getCrowiForJquery(),n}return a(t,e),u(t,[{key:"isInterceptWhen",value:function(e){return"postPreProcess"===e}},{key:"process",value:function(e){var t=Object.assign(arguments.length<=1?void 0:arguments[1]);return Object.keys(t.dcbContextMap).forEach((function(e){var n=t.dcbContextMap[e];t.markdown=t.markdown.replace(n.substituteContent,n.content)})),Promise.resolve(t)}}]),t})(c.BasicInterceptor)},548:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),i=n(549),u=r(i),s=n(550),l=r(s),c=n(728),f=r(c),p=n(729),d=r(p),h=n(730),m=r(h),y=n(731),b=r(y),v=n(733),g=r(v),w=n(734),_=r(w),k=n(735),O=r(k),E=n(736),P=r(E),j=(function(){function e(t){o(this,e),this.crowi=t,this.preProcessors=[new f.default(t),new d.default(t),new m.default(t)],this.postProcessors=[new b.default(t),new g.default(t)],this.langProcessors={tsv:new _.default(t),"tsv-h":new _.default(t,{header:!0}),template:new O.default(t),plantuml:new P.default(t)},this.parseMarkdown=this.parseMarkdown.bind(this),this.codeRenderer=this.codeRenderer.bind(this)}return a(e,[{key:"preProcess",value:function(e,t){for(var n=0;n<this.preProcessors.length;n++)this.preProcessors[n].process&&(e=this.preProcessors[n].process(e,t));return e}},{key:"postProcess",value:function(e,t){for(var n=0;n<this.postProcessors.length;n++)this.postProcessors[n].process&&(e=this.postProcessors[n].process(e,t));return e}},{key:"codeRenderer",value:function(e,t,n){var r="",o=void 0;if(t){var a=t.split(":"),i=a[0],u=a[1]||null;if(this.langProcessors[i])return this.langProcessors[i].process(e,t);try{o=l.default.highlight(i,e),r=o.value,!0}catch(t){r=e}r=escape?r:Crowi.escape(r,!0);var s="";return u&&(s="<cite>"+u+"</cite>"),'<pre class="wiki-code wiki-lang">'+s+'<code class="lang-'+t+'">'+r+"\n</code></pre>\n"}return'<pre class="wiki-code"><code>'+Crowi.escape(e,!0)+"\n</code></pre>"}},{key:"parseMarkdown",value:function(e,t,n){var r="",o=new u.default.Renderer;o.code=this.codeRenderer;try{var a=Object.assign({gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,renderer:o},n);u.default.setOptions(a),u.default.Lexer.lex=function(e,t){var n=new u.default.Lexer(t);return n.rules&&(n.rules.fences=/^ *(`{3,}|~{3,})[ \.]*([^\r\n]+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/),n.lex(e)},r=(0,u.default)(e)}catch(e){console.log(e,e.stack)}return r}},{key:"render",value:function(e,t,n){var r="";return r=this.parseMarkdown(e,t,n.marked||{}),r=this.postProcess(r,t)}}]),e})();t.default=j},59:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1106),f=r(c),p=n(1),d=r(p),h=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"getUserPicture",value:function(e){return!0===e.isGravatarEnabled?this.generateGravatarSrc(e):e.image||"/images/userpicture.png"}},{key:"generateGravatarSrc",value:function(e){return"https://gravatar.com/avatar/"+(0,f.default)(e.email.trim().toLowerCase())}},{key:"getClassName",value:function(){var e=["picture","picture-rounded"];return this.props.size&&e.push("picture-"+this.props.size),e.join(" ")}},{key:"render",value:function(){var e=this.props.user;return l.default.createElement("img",{src:this.getUserPicture(e),alt:e.username,className:this.getClassName()})}}]),t})(l.default.Component);t.default=h,h.propTypes={user:d.default.object.isRequired,size:d.default.string},h.defaultProps={user:{},size:null}},728:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=(function(){function e(){r(this,e)}return o(e,[{key:"process",value:function(e){return e.replace(/^(#{1,})((?![\s\#]+).+)$/gm,"$1 $2").replace(/>[\s]*\n>[\s]*\n/g,"> <br>\n> \n")}}]),e})();t.default=a},729:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=(function(){function e(){r(this,e)}return o(e,[{key:"process",value:function(e){return e.replace(/<((\/[^>\n]+?){2,})>/g,'<a href="$1">$1</a>').replace(/\[(\/[^\]\n]+?)\](?!\()/g,'<a href="$1">$1</a>')}}]),e})();t.default=a},730:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=(function(){function e(){r(this,e)}return o(e,[{key:"process",value:function(e){return e.replace(/\s(https?:\/\/[\S]+\.(jpg|jpeg|gif|png))/g,' <a href="$1"><img src="$1" class="auto-expanded-image"></a>')}}]),e})();t.default=a},731:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=n(732),i=(function(e){return e&&e.__esModule?e:{default:e}})(a),u=(function(){function e(){r(this,e),i.default.setConfig({img_dir:"https://github.global.ssl.fastly.net/images/icons/emoji/"})}return o(e,[{key:"process",value:function(e){return i.default.replace(e)}}]),e})();t.default=u},733:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=(function(){function e(t){if(r(this,e),this.crowi=t,this.defaultUrl="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?skipStartupTypeset=true",this.mathJaxConfigured=!1,t.getConfig().env.MATHJAX){if(this.mathJaxConfigured=!0,t.window.MathJax)return;var n=t.document,o=n.getElementsByTagName("head")[0],a=n.createElement("script");a.type="text/x-mathjax-config",a.text="MathJax.Hub.Config({\n      extensions: [\"tex2jax.js\"],\n      jax: [\"input/TeX\", \"output/SVG\"],\n      tex2jax: {\n        inlineMath: [ ['$','$'] ],\n        displayMath: [ ['$$','$$'] ],\n        processEscapes: true\n      },\n      showMathMenu: false,\n      showMathMenuMSIE: false,\n      showProcessingMessages: false,\n      messageStyle: \"none\",\n      skipStartupTypeset: true\n    });",o.appendChild(a);var i=n.createElement("script");i.type="text/javascript",i.src=this.defaultUrl,o.appendChild(i)}this.process=this.process.bind(this)}return o(e,[{key:"process",value:function(e,t){var n=this;if(!this.mathJaxConfigured)return e;var r=setInterval((function(){if(n.crowi.window.MathJax){var e=n.crowi.window.MathJax;e.Hub.Queue(["Typeset",e.Hub,t.id]),clearInterval(r)}}),100);return e}}]),e})();t.default=a},734:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=(function(){function e(t,n){r(this,e),n||(n={}),this.option=n,this.option.header=this.option.header||!1}return o(e,[{key:"getCols",value:function(e){for(var t=0,n=0;n<e;n++)t<e.length&&(t=e.length);return t}},{key:"splitColums",value:function(e){return e.split(/\s{4}/g)}},{key:"getTableHeader",value:function(e,t){var n=[],r=e[0]||"";return n=this.splitColums(r).map((function(e){return"<th>"+Crowi.escape(e)+"</th>"})),n.length<t.cols&&n.concat(new Array(t.cols-n.length)),"<tr>\n      "+n.join("\n")+"\n    </tr>"}},{key:"getTableBody",value:function(e,t){var n=this,r=void 0;return this.option.header&&e.shift(),r=e.map((function(e){return"<tr>"+n.splitColums(e).map((function(e){return"<td>"+Crowi.escape(e)+"</td>"})).join("")+"</tr>"})),r.join("\n")}},{key:"process",value:function(e){var t={},n=e.split(/\n|\r/);t.cols=this.getCols(n);var r="";return this.option.header&&(r="<thead>\n        "+this.getTableHeader(n,t)+"\n      </thead>"),"<table>\n      "+r+"\n      <tbody>\n        "+this.getTableBody(n,t)+"\n      </tbody>\n    </table>"}}]),e})();t.default=a},735:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),a=n(66),i=(function(e){return e&&e.__esModule?e:{default:e}})(a),u=(function(){function e(t){r(this,e),this.templatePattern={year:this.getYear,month:this.getMonth,date:this.getDate,user:this.getUser}}return o(e,[{key:"getYear",value:function(){return(0,i.default)().format("YYYY")}},{key:"getMonth",value:function(){return(0,i.default)().format("YYYY/MM")}},{key:"getDate",value:function(){return(0,i.default)().format("YYYY/MM/DD")}},{key:"getUser",value:function(){var e=window.crowi.me||null;return e?"/user/"+e:""}},{key:"parseTemplateString",value:function(e){var t=this,n=e;return Object.keys(this.templatePattern).forEach((function(e){var r=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=new RegExp("{"+r+"}","g");if(n.match(o)){var a=t.templatePattern[e]();n=n.replace(o,a)}})),n}},{key:"process",value:function(e,t){var n=(new Date).getTime().toString(16)+Math.floor(1e3*Math.random()).toString(16),r=t;return t.match(":")&&(r=this.parseTemplateString(t.split(":")[1])),e=this.parseTemplateString(e),'\n    <div class="page-template-builder">\n    <button class="template-create-button btn btn-default" data-template="'+n+'" data-path="'+r+'"><i class="fa fa-pencil"></i> '+r+'</button>\n      <pre><code id="'+n+'" class="lang-'+t+'">'+e+"\n</code></pre></div>\n"}}]),e})();t.default=u},736:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),i=n(737),u=r(i),s=n(281),l=(r(s),(function(){function e(t){o(this,e),this.crowi=t}return a(e,[{key:"generateId",value:function(e){var t=n(281).createHash("md5");return t.update(e),t.digest("hex")}},{key:"process",value:function(e,t){var n=crowi.getConfig();if(!n.env.PLANTUML_URI)return'<pre class="wiki-code"><code>'+Crowi.escape(e,!0)+"\n</code></pre>";var r=n.env.PLANTUML_URI;return"/"!==r.substr(-1)&&(r+="/"),'\n      <div id="'+this.generateId(e+t)+'" class="plantuml noborder">\n        <img src="'+r+"svg/"+u.default.encode("@startuml\n\nskinparam monochrome true\n\n"+e+"\n@enduml")+'">\n      </div>\n    '}}]),e})());t.default=l},752:function(e,t){},782:function(e,t){},783:function(e,t){},82:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(1),f=r(c),p=(function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){var e=this.props.name||null,t=this.props.spin?" fa-spinner":"";return e?l.default.createElement("i",{className:"fa fa-"+e+" "+t}):""}}]),t})(l.default.Component);t.default=p,p.propTypes={name:f.default.string.isRequired,spin:f.default.bool},p.defaltProps={spin:!1}},827:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(828),f=r(c),p=(function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),u(t,[{key:"render",value:function(){return l.default.createElement("div",{className:"search-box"},l.default.createElement(f.default,null))}}]),t})(l.default.Component);t.default=p,p.propTypes={},p.defaultProps={}},828:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})(),s=n(0),l=r(s),c=n(183),f=n(963),p=n(272),d=(r(p),n(59)),h=r(d),m=n(408),y=r(m),b=n(409),v=r(b),g=n(1),w=(r(g),(function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.crowi=window.crowi,n.state={input:"",keyword:"",searchedKeyword:"",pages:[],searchError:null},n.search=n.search.bind(n),n.clearForm=n.clearForm.bind(n),n.getFormClearComponent=n.getFormClearComponent.bind(n),n.renderMenuItemChildren=n.renderMenuItemChildren.bind(n),n.onInputChange=n.onInputChange.bind(n),n.onChange=n.onChange.bind(n),n}return i(t,e),u(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"search",value:function(e){var t=this;if(""===e)return void this.setState({keyword:"",searchedKeyword:""});this.crowi.apiGet("/search",{q:e}).then((function(e){t.setState({keyword:"",pages:e.data})})).catch((function(e){t.setState({searchError:e})}))}},{key:"getFormClearComponent",value:function(){var e=0===this.state.input.length;return e?l.default.createElement("span",null):l.default.createElement("a",{className:"btn btn-link search-top-clear",onClick:this.clearForm,hidden:e},l.default.createElement("i",{className:"fa fa-times-circle"}))}},{key:"clearForm",value:function(){this._typeahead.getInstance().clear(),this.setState({keyword:""})}},{key:"onInputChange",value:function(e){this.setState({input:e})}},{key:"onChange",value:function(e){var t=e[0];window.location=t.path}},{key:"renderMenuItemChildren",value:function(e,t,n){var r=e;return l.default.createElement("span",null,l.default.createElement(h.default,{user:r.revision.author}),l.default.createElement(v.default,{page:r}),l.default.createElement(y.default,{page:r}))}},{key:"render",value:function(){var e=this,t=null!==this.state.searchError?"Error on searching.":"No matches found on title... Hit [Enter] key so that search on contents.",n=this.getFormClearComponent();return l.default.createElement("form",{action:"/_search",className:"search-form form-group input-group search-top-input-group"},l.default.createElement(c.FormGroup,null,l.default.createElement(c.InputGroup,null,l.default.createElement(f.AsyncTypeahead,{ref:function(t){return e._typeahead=t},name:"q",labelKey:"path",minLength:2,options:this.state.pages,placeholder:"Search ...",emptyLabel:t,align:"left",submitFormOnEnter:!0,onSearch:this.search,onInputChange:this.onInputChange,onChange:this.onChange,renderMenuItemChildren:this.renderMenuItemChildren}),n,l.default.createElement(c.InputGroup.Button,null,l.default.createElement(c.Button,{type:"submit"},l.default.createElement("i",{className:"search-top-icon fa fa-search"}))))))}}]),t})(l.default.Component));t.default=w,w.propTypes={},w.defaultProps={}}},[434]);