webpackJsonp([4],{1149:function(e,t,a){"use strict";(function(e){var t=a(1150);a(66);a(427),a(1170);var n={};window||(window={}),window.Crowi=n,n.createErrorView=function(t){e("#main").prepend(e('<p class="alert-message error">'+t+"</p>"))},n.correctHeaders=function(t){var a=e(t||"#revision-body-content"),n=0;e("h1,h2,h3,h4,h5,h6",a).each((function(t,a){var o="head"+n++;e(this).attr("id",o),e(this).addClass("revision-head"),e(this).append('<span class="revision-head-link"><a href="#'+o+'"><i class="fa fa-link"></i></a></span>')}))},n.appendEditSectionButtons=function(t,a){var n=e(t||"#revision-body-content");e("h1,h2,h3,h4,h5,h6",n).each((function(t,n){var o=e(this).text(),i=new RegExp("[^\r\n]*#+[^\r\n]*"+o+"[^\r\n]*"),r=a.search(i);r<0&&(r=a.search(o)),e(this).append('\n      <span class="revision-head-edit-button">\n        <a href="#edit-form" onClick="Crowi.setCaretPositionToFormBody('+r+')">\n          <i class="fa fa-edit"></i>\n        </a>\n      </span>\n      ')}))},n.setCaretPositionToFormBody=function(e){document.querySelector("#form-body").setAttribute("data-caret-position",e)},n.revisionToc=function(t,a){var n=e(t||"#revision-body-content"),o=e(a||"#revision-toc"),i=e('<div id="revision-toc-content" class="revision-toc-content collapse in"></div>');o.append(i),e("h1",n).each((function(t,a){var n=e(this).attr("id"),o=e(this).text(),r="#"+n+" ~ h2:not(#"+n+" ~ h1 ~ h2)",s=e("<ul></ul>"),c=e('<li><a href="#'+n+'">'+o+"</a></li>");i.append(s),s.append(c),e(r).each((function(){var t=e(this).attr("id"),a=e(this).text(),n="#"+t+" ~ h3:not(#"+t+" ~ h2 ~ h3)",o=e("<ul></ul>"),i=e('<li><a href="#'+t+'">'+a+"</a></li>");c.append(o),o.append(i),e(n).each((function(){var t=e(this).attr("id"),a=e(this).text(),n=e("<ul></ul>"),o=e('<li><a href="#'+t+'">'+a+"</a></li>");i.append(n),n.append(o)}))}))}))},n.escape=function(e){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")},n.unescape=function(e){return e=e.replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'").replace(/&quot;/g,'"')},n.userPicture=function(e){return e?e.image||"/images/userpicture.png":"/images/userpicture.png"},n.modifyScrollTop=function(){var e=window.location.hash;if(""!==e){var t=document.querySelector("#page-header");if(t){var a=t.getBoundingClientRect(),n=document.querySelector(e);if(null!==n){var o=0;0===window.scrollY&&(o=200),setTimeout((function(){n.getBoundingClientRect().top>=a.bottom||window.scrollTo(0,window.scrollY-a.height-10)}),o)}}}},e((function(){var a=JSON.parse(document.getElementById("crowi-context-hydrate").textContent||"{}"),o=e("#content-main").data("page-id"),i=(e("#content-main").data("page-revision-id"),e("#content-main").data("page-revision-created"),e("#content-main").data("current-user"),e("#content-main").data("page-is-seen")),r=e("#content-main").data("path"),s=e("#content-main").data("linebreaks-enabled"),c=a.isSavedStatesOfTabChanges,d={marked:{breaks:s}};if(e('[data-toggle="popover"]').popover(),e('[data-toggle="tooltip"]').tooltip(),e("[data-tooltip-stay]").tooltip("show"),e("#toggle-sidebar").click((function(t){var a=e(".main-container");return a.hasClass("aside-hidden")?(e(".main-container").removeClass("aside-hidden"),e.cookie("aside-hidden",0,{expires:30,path:"/"})):(a.addClass("aside-hidden"),e.cookie("aside-hidden",1,{expires:30,path:"/"})),!1})),1==e.cookie("aside-hidden")&&e(".main-container").addClass("aside-hidden"),e(".copy-link").on("click",(function(){e(this).select()})),e("#create-page").on("shown.bs.modal",(function(t){var a=new Date,n=("0"+(a.getMonth()+1)).slice(-2),o=("0"+a.getDate()).slice(-2),i=a.getFullYear()+"/"+n+"/"+o;e("#create-page-today .page-today-suffix").text("/"+i+"/"),e("#create-page-today .page-today-input2").data("prefix","/"+i+"/");var r=e("#create-page-today .col-xs-10").outerWidth()-1,s=r-e("#create-page-today .page-today-prefix").outerWidth()-e("#create-page-today .page-today-input1").outerWidth()-e("#create-page-today .page-today-suffix").outerWidth()-42;e("#create-page-today .form-control.page-today-input2").css({width:s}).focus()})),e("#create-page-today").submit((function(t){var a=e("input.page-today-input1",this).data("prefix"),n=e("input.page-today-input1",this).val(),o=e("input.page-today-input2",this).data("prefix"),i=e("input.page-today-input2",this).val();return""===n&&(a="メモ"),""===i&&(o=o.slice(0,-1)),top.location.href=a+n+o+i+"#edit-form",!1})),e("#create-page-under-tree").submit((function(t){var a=e("input",this).val();return a.match(/^\//)||(a="/"+a),a.match(/.+\/$/)&&(a=a.substr(0,a.length-1)),top.location.href=a+"#edit-form",!1})),e("#renamePage").on("shown.bs.modal",(function(t){e("#newPageName").focus()})),e("#renamePageForm, #unportalize-form").submit((function(t){var a={};return e(this).serializeArray().forEach((function(e){a[e.name]=e.value})),e.ajax({type:"POST",url:"/_api/pages.rename",data:e(this).serialize(),dataType:"json"}).done((function(t){if(t.ok){var n=t.page;e("#newPageNameCheck").removeClass("alert-danger"),e("#newPageNameCheck").html('<img src="/images/loading_s.gif"> Page moved! Redirecting to new page location.'),setTimeout((function(){top.location.href=n.path+"?renamed="+r}),1e3)}else e("#newPageNameCheck").html('<i class="fa fa-times-circle"></i> '+t.error),e("#newPageNameCheck").addClass("alert-danger"),e("#linkToNewPage").html('\n          <i class="fa fa-fw fa-arrow-right"></i><a href="'+a.new_path+'">'+a.new_path+"</a>\n        ")})),!1})),e("#delete-page-form").submit((function(t){return e.ajax({type:"POST",url:"/_api/pages.remove",data:e("#delete-page-form").serialize(),dataType:"json"}).done((function(t){if(t.ok){var a=t.page;top.location.href=a.path}else e("#delete-errors").html('<i class="fa fa-times-circle"></i> '+t.error),e("#delete-errors").addClass("alert-danger")})),!1})),e("#revert-delete-page-form").submit((function(t){return e.ajax({type:"POST",url:"/_api/pages.revertRemove",data:e("#revert-delete-page-form").serialize(),dataType:"json"}).done((function(t){if(t.ok){var a=t.page;top.location.href=a.path}else e("#delete-errors").html('<i class="fa fa-times-circle"></i> '+t.error),e("#delete-errors").addClass("alert-danger")})),!1})),e("#unlink-page-form").submit((function(t){return e.ajax({type:"POST",url:"/_api/pages.unlink",data:e("#unlink-page-form").serialize(),dataType:"json"}).done((function(t){if(t.ok){var a=t.page;top.location.href=a.path+"?unlinked=true"}else e("#delete-errors").html('<i class="fa fa-times-circle"></i> '+t.error),e("#delete-errors").addClass("alert-danger")})),!1})),e("#create-portal-button").on("click",(function(t){e(".portal").removeClass("hide"),e(".content-main").addClass("on-edit"),e('.portal a[data-toggle="tab"][href="#edit-form"]').tab("show");var a=e(".content-main").data("path");if("/"!=a&&""==e(".content-main").data("page-id")){var n=a.substr(0,a.length-1);e.get("/_api/pages.get",{path:n},(function(t){t.ok&&t.page&&e("#portal-warning-modal").modal("show")}))}})),e("#portal-form-close").on("click",(function(t){return e(".portal").addClass("hide"),e(".content-main").removeClass("on-edit"),!1})),e(".page-list-link").each((function(){var t=e(this),a=(t.text(),t.data("path")),o=new String(t.data("short-path"));a=n.escape(a);var i=(function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")})(n.escape(o))+"(/)?$";t.html(a.replace(new RegExp(i),"<strong>"+o+"$1</strong>"))})),e('a[data-toggle="tab"][href="#view-timeline"]').on("show.bs.tab",(function(){0==e("#view-timeline").data("shown")&&(e("#view-timeline .timeline-body").each((function(){var t=e(this).attr("id"),a="#"+t+" > script",o="#"+t+" .revision-body",i=e(o),r=n.unescape(e(a).html()),s=crowiRenderer.render(r,i.get(0),d);i.html(s),e(".template-create-button",o).on("click",(function(){var t=e(this).data("path"),a=e(this).data("template"),n=e("#"+a).html();crowi.saveDraft(t,n),top.location.href=t}))})),e("#view-timeline").data("shown",1))})),e("#register").on("click",(function(){return e("#login-dialog").addClass("to-flip"),!1})),e("#login").on("click",(function(){return e("#login-dialog").removeClass("to-flip"),!1})),e('#register-form input[name="registerForm[username]"]').change((function(t){var a=e(this).val();e("#input-group-username").removeClass("has-error"),e("#help-block-username").html(""),e.getJSON("/_api/check_username",{username:a},(function(t){t.valid||(e("#help-block-username").html('<i class="fa fa-warning"></i> This User ID is not available.<br>'),e("#input-group-username").addClass("has-error"))}))})),o){var l=function(){w.addClass("active"),w.data("liked",1),b.text(parseInt(b.text())+1)},h=function(){w.removeClass("active"),w.data("liked",0),b.text(parseInt(b.text())-1)},p=function(t){var a=e("<a>");a.data("user-id",t._id),a.attr("href","/user/"+t.username),a.attr("title",t.name);var o=e('<img class="picture picture-xs picture-rounded">');return o.attr("alt",t.name),o.attr("src",n.userPicture(t)),a.append(o),a};if(e("#raw-text-original").length>0){var u=n.unescape(e("#raw-text-original").html()),f=e("#revision-body-content").get(0),g={markdown:u,dom:f,currentPagePath:decodeURIComponent(location.pathname)};crowi.interceptorManager.process("preRender",g).then((function(){return crowi.interceptorManager.process("prePreProcess",g)})).then((function(){g.markdown=crowiRenderer.preProcess(g.markdown,g.dom)})).then((function(){return crowi.interceptorManager.process("postPreProcess",g)})).then((function(){var t=(e("#revision-body-content"),crowiRenderer.render(g.markdown,g.dom,d));g.parsedHTML=t,Promise.resolve(g)})).then((function(){return crowi.interceptorManager.process("postRender",g)})).then((function(){return crowi.interceptorManager.process("preRenderHtml",g)})).then((function(){e("#revision-body-content").html(g.parsedHTML),e(".template-create-button").on("click",(function(){var t=e(this).data("path"),a=e(this).data("template"),n=e("#"+a).html();crowi.saveDraft(t,n),top.location.href=t})),n.correctHeaders("#revision-body-content"),n.appendEditSectionButtons("#revision-body-content",u),n.revisionToc("#revision-body-content","#revision-toc"),Promise.resolve(e("#revision-body-content"))})).then((function(e){return g=Object.assign(g,{bodyElement:e}),crowi.interceptorManager.process("postRenderHtml",g)}))}var m=e("#page-header");if(m.length>0){var v=m.outerHeight(!0);e(".header-wrap").css({height:v+16+"px"}),m.affix({offset:{top:function(){return v+86}}}),e("[data-affix-disable]").on("click",(function(t){var a=e(e(this).data("affix-disable"));return e(window).off(".affix"),a.removeData("affix").removeClass("affix affix-top affix-bottom"),!1}))}var w=e(".like-button"),b=e("#like-count");w.click((function(){var t=w.data("liked"),a=w.data("csrftoken");return t?e.post("/_api/likes.remove",{_csrf:a,page_id:o},(function(e){e.ok&&h()})):e.post("/_api/likes.add",{_csrf:a,page_id:o},(function(e){e.ok&&l()})),!1}));var y=e("#liker-list"),k=y.data("likers");if(k&&k.length>0){var C=crowi.findUserByIds(k.split(","));C&&(function(t){e.each(t,(function(e,t){y.append(p(t))}))})(C)}i||e.post("/_api/pages.seen",{page_id:o},(function(t){t.ok&&t.seenUser&&e("#content-main").data("page-is-seen",1)}));var x=!1,S=e("body");e(document).on("click",".toggle-presentation",(function(t){var a=e(this);t.preventDefault(),S.toggleClass("overlay-on"),x||(x=!0,e("<iframe />").attr({src:a.attr("href")}).appendTo(e("#presentation-container")))})).on("click",".fullscreen-layer",(function(){S.toggleClass("overlay-on")}));var P=e("body").data("me");t().on("page edited",(function(t){t.user._id!=P&&t.page.path==r&&(e("#notifPageEdited").show(),e("#notifPageEdited .edited-user").html(t.user.name))}))}c?(e('a[data-toggle="tab"][href="#revision-history"]').on("show.bs.tab",(function(){window.location.hash="#revision-history",window.history.replaceState("","History","#revision-history")})),e('a[data-toggle="tab"][href="#edit-form"]').on("show.bs.tab",(function(){window.location.hash="#edit-form",window.history.replaceState("","Edit","#edit-form")})),e('a[data-toggle="tab"][href="#revision-body"]').on("show.bs.tab",(function(){window.location.hash="#",window.history.replaceState("","",location.href)}))):(e('a[data-toggle="tab"][href="#revision-history"]').on("show.bs.tab",(function(){window.history.replaceState("","History","#revision-history")})),e('a[data-toggle="tab"][href="#edit-form"]').on("show.bs.tab",(function(){window.history.replaceState("","Edit","#edit-form")})),e('a[data-toggle="tab"][href="#revision-body"]').on("show.bs.tab",(function(){window.history.replaceState("","",location.href.replace(location.hash,""))})),e(document).on("click",'a[href="#edit-form"]',(function(){window.location.replace("#edit-form")})))})),n.getRevisionBodyContent=function(){return e("#revision-body-content").html()},n.replaceRevisionBodyContent=function(t){e("#revision-body-content").html(t)},n.findHashFromUrl=function(e){var t;return(t=e.match(/#(.+)$/))?"#"+t[1]:""},n.unhighlightSelectedSection=function(t){if(!t||""==t||!t.match(/^#head.+/))return!0;e(t).removeClass("highlighted")},n.highlightSelectedSection=function(t){if(!t||""==t||!t.match(/^#head.+/))return!0;e(t).addClass("highlighted")},window.addEventListener("load",(function(t){if(location.hash&&("#edit-form"==location.hash&&e('a[data-toggle="tab"][href="#edit-form"]').tab("show"),"#revision-history"==location.hash&&e('a[data-toggle="tab"][href="#revision-history"]').tab("show")),crowi&&crowi.users||0==crowi.users.length){var a=crowi.users.length;e(".page-list-liker").each((function(t,n){var o=e(n).data("count")||0;o/a>.05?e(n).addClass("popular-page-high"):o/a>.02?e(n).addClass("popular-page-mid"):o/a>.005&&e(n).addClass("popular-page-low")}));e(".page-list-seer").each((function(t,n){var o=e(n).data("count")||0;o/a>.1?e(n).addClass("popular-page-high"):o/a>.05?e(n).addClass("popular-page-mid"):o/a>.02&&e(n).addClass("popular-page-low")}))}n.highlightSelectedSection(location.hash),n.modifyScrollTop()})),window.addEventListener("hashchange",(function(t){n.unhighlightSelectedSection(n.findHashFromUrl(t.oldURL)),n.highlightSelectedSection(n.findHashFromUrl(t.newURL)),n.modifyScrollTop(),location.hash&&("#edit-form"==location.hash&&e('a[data-toggle="tab"][href="#edit-form"]').tab("show"),"#revision-history"==location.hash&&e('a[data-toggle="tab"][href="#revision-history"]').tab("show")),(""==location.hash||location.hash.match(/^#head.+/))&&e('a[data-toggle="tab"][href="#revision-body"]').tab("show")}))}).call(t,a(18))},1166:function(e,t){},18:function(e,t){e.exports=jQuery},279:function(e,t,a){function n(e){return a(o(e))}function o(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./ja":116,"./ja.js":116};n.keys=function(){return Object.keys(i)},n.resolve=o,e.exports=n,n.id=279}},[1149]);